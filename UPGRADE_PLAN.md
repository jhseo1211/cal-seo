# 신짜 계산기 업그레이드 계획서

## 1. 프로젝트 개요
- Godot 4.5 기반 데스크톱/웹용 경량 계산기.
- 현행 기능: 기본 사칙연산, 단일 씬(`Calculator.tscn`) 구조, 최소 UI.
- 목표: 학습자와 파워 유저 모두를 겨냥한 "신짜 계산기"로 확장하여 생산성과 차별성을 확보.

## 2. 현재 상태 진단
- **구조**: 모든 로직이 단일 스크립트(`Calculator.gd`)에 집중되어 확장성 제한.
- **UX**: 결과 영역과 입력 필드만 존재, 이력/모드 없음.
- **테스트**: 자동화 부재, 수동 검증 의존.
- **현지화**: 기본 한글 UI이나 문자열 관리 미흡(`tr()` 미사용).

## 3. 목표 및 핵심 지표
- **기능**: 고급 연산(과학, 통계), 히스토리, 사용자 정의 기능 제공.
- **품질**: 유닛 테스트 커버리지 60% 이상, 주요 시나리오 자동화.
- **UX**: 작업 플로우 3회 이하 클릭으로 완료, 반응형 레이아웃.
- **배포**: 데스크톱 + Web Export 안정화.

## 4. 기능 업그레이드 로드맵
### 4.1 필수 기능 (스프린트 1-2)
1. **모듈화**: `CalculatorCore.gd`(연산), `CalculatorUI.gd`(UI), `HistoryStore.gd`(데이터) 분리.
2. **히스토리 패널**: 최근 연산 20개 저장/선택 재실행.
3. **과학 계산 모드**: 삼각함수, 거듭제곱, 루트, 상수(π, e) 지원.
4. **입력 보정**: 실시간 파싱, 오류 하이라이트, 소수점 제한.

### 4.2 고급 기능 (스프린트 3-4)
1. **프리셋/즐겨찾기**: 자주 쓰는 식 저장.
2. **세션 저장**: `user://` 경로에 자동 영속화.
3. **다국어 지원**: `Localization.csv`로 문자열 통합, 한/영/중 3개 언어 제공.
4. **접근성**: 키보드 단축키, 스크린리더 친화 라벨링.

## 5. 기술 및 구조 개선
- 씬 구조: `Main.tscn` → `CalculatorViewport`(UI) + `Overlay`(설정/툴팁).
- 신호 설계: Signal bus(`GameBus.gd`) 도입으로 UI-로직 분리.
- 연산 엔진: 전략 패턴으로 연산자 등록(`OperationRegistry`), 커스텀 함수 플러그인화.
- 데이터: `HistoryStore`는 JSON 직렬화 및 버전 관리.

## 6. UI/UX 개편 계획
- 레이아웃: 좌측 연산 패드, 우측 히스토리/즐겨찾기 탭.
- 테마: 다크/라이트 테마 전환, Godot Theme 리소스 활용.
- 피드백: 계산 성공 시 애니메이션, 오류 시 진동 효과(`Tween`).
- 온보딩: 첫 실행 가이드 모달과 단축키 퀵시트.

## 7. 테스트 및 품질 전략
- **단위 테스트**: GUT 기반, `tests/unit/test_operations.gd` 등 구성.
- **시나리오 테스트**: Godot headless + `--run` 스크립트로 자동 UI 시퀀스.
- **CI 파이프라인**: GitHub Actions에서 lint(기본 GDScript 스타일 체크) → 테스트 → web export.
- **코드 리뷰 체크리스트**: 모듈 책임, 신호 누락, 현지화 키 검증.

## 8. 일정 제안 (6주)
1. **주 1-2**: 구조 리팩터링, 히스토리, 테스트 프레임 도입.
2. **주 3-4**: 과학 계산, 즐겨찾기, 세션 저장.
3. **주 5**: UI 리디자인, 다국어, 접근성.
4. **주 6**: QA, 퍼포먼스 튜닝, Web Export, 문서화.

## 9. 리스크 및 대응
- **연산 정확도**: 고정 소수점 vs 부동소수 처리 → Godot `Big` 라이브러리 검토, 임계 테스트.
- **성능**: Web 빌드에서의 부하 → 입력 디바운스, 연산 스레드 분리 검토.
- **현지화 유지보수**: 문자열 누락 → CI에서 키 비교 스크립트 추가.
- **배포 일정**: 리소스 부족 시 고급 기능을 후속 릴리즈로 분리.

## 10. 차별화 옵션 (선택 적용)
1. **AI 계산 어시스트**: LLM 연동(오프라인 캐시)으로 자연어 수식 해석 및 단계별 풀이 제공.
2. **학습 모드**: 문제 생성기 + 단계별 힌트, 학교 수학 커리큘럼 연동.
3. **데이터 시각화**: 결과를 그래프(2D Plot)로 즉시 시각화, 함수 탭 추가.
4. **협업 기능**: 계산 시트를 공유/동시 편집 가능한 WebRTC 세션.
5. **플러그인 마켓**: 사용자 정의 연산자/테마를 `.pck` 모듈로 설치.

## 11. 필요 리소스
- Godot 4.5 개발자 1명(리드), UI/UX 디자이너 1명, QA 1명.
- 디자인 툴(Figma) + 번역 협업(POEditor) + GitHub Actions 런너.

## 12. 성공 기준
- 사용자 테스트에서 만족도 4.5/5 이상.
- 월간 활성 사용자 30% 증가.
- 크래시/심각 오류 0건으로 첫 릴리즈 완료.
